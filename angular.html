<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Angular Kinematics &#8212; Learn Multibody Dynamics</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=75810a84" />
    <link rel="stylesheet" type="text/css" href="_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=61ad4bda" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS": {"linebreaks": {"automatic": true}}})</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Translational Kinematics" href="translational.html" />
    <link rel="prev" title="Vector Differentiation" href="differentiation.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=teal data-md-color-accent=deep-orange>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#angular" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Learn Multibody Dynamics"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#xe52f</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Learn Multibody Dynamics</span>
          <span class="md-header-nav__topic"> Angular Kinematics </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/moorepants/learn-multibody-dynamics/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Learn Multibody Dynamics
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Home</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Learn Multibody Dynamics" class="md-nav__button md-logo">
      
        <i class="md-icon">&#xe52f</i>
      
    </a>
    <a href="index.html"
       title="Learn Multibody Dynamics">Learn Multibody Dynamics</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/moorepants/learn-multibody-dynamics/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Learn Multibody Dynamics
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Table of Contents</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="introduction.html" class="md-nav__link">Introduction</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="license.html" class="md-nav__link">License</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="install.html" class="md-nav__link">Install the Software</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="jupyter-python.html" class="md-nav__link">Jupyter and Python</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sympy.html" class="md-nav__link">SymPy</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="orientation.html" class="md-nav__link">Orientation of Reference Frames</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="vectors.html" class="md-nav__link">Vectors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="differentiation.html" class="md-nav__link">Vector Differentiation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Angular Kinematics </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Angular Kinematics</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#angular--page-root" class="md-nav__link">Angular Kinematics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#learning-objectives" class="md-nav__link">Learning Objectives</a>
        </li>
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#angular-velocity" class="md-nav__link">Angular Velocity</a>
        </li>
        <li class="md-nav__item"><a href="#angular-velocity-of-simple-orientations" class="md-nav__link">Angular Velocity of Simple Orientations</a>
        </li>
        <li class="md-nav__item"><a href="#body-fixed-orientations" class="md-nav__link">Body Fixed Orientations</a>
        </li>
        <li class="md-nav__item"><a href="#time-derivatives-of-vectors" class="md-nav__link">Time Derivatives of Vectors</a>
        </li>
        <li class="md-nav__item"><a href="#addition-of-angular-velocity" class="md-nav__link">Addition of Angular Velocity</a>
        </li>
        <li class="md-nav__item"><a href="#angular-acceleration" class="md-nav__link">Angular Acceleration</a>
        </li>
        <li class="md-nav__item"><a href="#addition-of-angular-acceleration" class="md-nav__link">Addition of Angular Acceleration</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/angular.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="translational.html" class="md-nav__link">Translational Kinematics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html" class="md-nav__link">Holonomic Constraints</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="motion.html" class="md-nav__link">Nonholonomic Constraints</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mass.html" class="md-nav__link">Mass Distribution</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="loads.html" class="md-nav__link">Force, Moment, and Torque</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="generalized-forces.html" class="md-nav__link">Generalized Forces</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="eom.html" class="md-nav__link">Unconstrained Equations of Motion</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="simulation.html" class="md-nav__link">Simulation and Visualization</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="visualization.html" class="md-nav__link">Three Dimensional Visualization</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="nonholonomic-eom.html" class="md-nav__link">Equations of Motion with Nonholonomic Constraints</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="holonomic-eom.html" class="md-nav__link">Equations of Motion with Holonomic Constraints</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="noncontributing.html" class="md-nav__link">Exposing Noncontributing Forces</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="energy.html" class="md-nav__link">Energy and Power</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lagrange.html" class="md-nav__link">Equations of Motion with the Lagrange Method</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tmt.html" class="md-nav__link">Unconstrained Equations of Motion with the TMT Method</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="notation.html" class="md-nav__link">Notation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="references.html" class="md-nav__link">References</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#angular--page-root" class="md-nav__link">Angular Kinematics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#learning-objectives" class="md-nav__link">Learning Objectives</a>
        </li>
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#angular-velocity" class="md-nav__link">Angular Velocity</a>
        </li>
        <li class="md-nav__item"><a href="#angular-velocity-of-simple-orientations" class="md-nav__link">Angular Velocity of Simple Orientations</a>
        </li>
        <li class="md-nav__item"><a href="#body-fixed-orientations" class="md-nav__link">Body Fixed Orientations</a>
        </li>
        <li class="md-nav__item"><a href="#time-derivatives-of-vectors" class="md-nav__link">Time Derivatives of Vectors</a>
        </li>
        <li class="md-nav__item"><a href="#addition-of-angular-velocity" class="md-nav__link">Addition of Angular Velocity</a>
        </li>
        <li class="md-nav__item"><a href="#angular-acceleration" class="md-nav__link">Angular Acceleration</a>
        </li>
        <li class="md-nav__item"><a href="#addition-of-angular-acceleration" class="md-nav__link">Addition of Angular Acceleration</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/angular.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="angular-kinematics">
<h1 id="angular--page-root">Angular Kinematics<a class="headerlink" href="#angular--page-root" title="Link to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can download this example as a Python script:
<a class="reference download internal" download="" href="_downloads/d4377bc742938685a413113ba50b80c6/angular.py"><code class="xref download docutils literal notranslate"><span class="pre">angular.py</span></code></a> or Jupyter Notebook:
<a class="reference download internal" download="" href="_downloads/2a38eea904048a2924d830789172f439/angular.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">angular.ipynb</span></code></a>.</p>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy.physics.mechanics</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">me</span>
<span class="n">me</span><span class="o">.</span><span class="n">init_vprinting</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="s1">'mathjax'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="invisible docutils container">
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ReferenceFrame</span><span class="p">(</span><span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'latexs'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">lab</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">tex</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'\hat{{</span><span class="si">{}</span><span class="s1">}}_</span><span class="si">{}</span><span class="s1">'</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ReferenceFrame</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span>
                                             <span class="n">latexs</span><span class="o">=</span><span class="p">(</span><span class="n">tex</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">),</span>
                                                     <span class="n">tex</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">),</span>
                                                     <span class="n">tex</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span> <span class="s1">'z'</span><span class="p">)),</span>
                                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span> <span class="o">=</span> <span class="n">ReferenceFrame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<section id="learning-objectives">
<h2 id="learning-objectives">Learning Objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">¶</a></h2>
<p>After completing this chapter readers will be able to:</p>
<ol class="arabic simple">
<li><p>apply the definition of angular velocity</p></li>
<li><p>calculate the angular velocity of simple rotations</p></li>
<li><p>choose Euler angles for a rotating reference frame</p></li>
<li><p>calculate the angular velocity of reference frames described by successive
simple rotations</p></li>
<li><p>derive the time derivative of a vector in terms of angular velocities</p></li>
<li><p>calculate the angular acceleration of a reference frame</p></li>
<li><p>calculate the angular acceleration of reference frames described by
successive rotations</p></li>
</ol>
</section>
<section id="introduction">
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>To apply <a class="reference external" href="https://en.wikipedia.org/wiki/Euler%27s_laws_of_motion">Euler’s Laws of Motion</a> to a multibody system we will need to
determine how the <a class="reference external" href="https://en.wikipedia.org/wiki/Angular_momentum">angular momentum</a> of each rigid body changes with time.
This requires specifying the angular kinematics of each body in the system:
typically both angular velocity and angular acceleration. Assuming that a
reference frame is fixed to a rigid body, we will start by finding the angular
kinematics of a single reference frame and then use the properties of
<a class="reference internal" href="orientation.html#successive-orientations"><span class="std std-ref">Successive Orientations</span></a> to find the angular kinematics of a set of
related reference frames.</p>
<p>In the video below, a small T-handle is shown spinning in low Earth orbit
gravity onboard the International Space Station. This single rigid body has an
orientation, angular velocity, and angular acceleration at any given instance
of time.</p>
<center>
<video controls="" height="360" width="640">
<source src="https://upload.wikimedia.org/wikipedia/commons/b/be/Dzhanibekov_effect.ogv" type="video/ogg"/>
<source src="https://mechmotum.s3.us-east-005.dream.io/dzhanibekow-effect.mp4" type="video/mp4"/>
  Your browser does not support the video tag.
</video>
<p>Public Domain, NASA</p>
</center><p>The T-handle exhibits unintuitive motion, reversing back and forth
periodically. This phenomena is commonly referred to as the “<a class="reference external" href="https://en.wikipedia.org/wiki/Tennis_racket_theorem">Dzhanibekov
effect</a>” and Euler’s Laws of Motion predict the behavior, which we will
investigate in later chapters. For now, we will learn how to specify the
angular kinematics of a reference frame in rotational motion, such as one fixed
to this T-handle.</p>
</section>
<section id="angular-velocity">
<h2 id="angular-velocity">Angular Velocity<a class="headerlink" href="#angular-velocity" title="Link to this heading">¶</a></h2>
<p>In Ch. <a class="reference internal" href="orientation.html#orientation-of-reference-frames"><span class="std std-ref">Orientation of Reference Frames</span></a> we learned that reference frames
can be oriented relative to each other. If the relative orientation of two
reference frames change with respect to time, then we can calculate the angular
velocity of reference frame <span class="math notranslate nohighlight">\(B\)</span> when observed from reference frame
<span class="math notranslate nohighlight">\(A\)</span>. This vector is written with the notation <span class="math notranslate nohighlight">\({}^A\bar{\omega}^B\)</span>.
If <span class="math notranslate nohighlight">\(\hat{b}_x,\hat{b}_y,\hat{b}_z\)</span> are right handed mutually
perpendicular unit vectors fixed in <span class="math notranslate nohighlight">\(B\)</span> then the angular velocity of
<span class="math notranslate nohighlight">\(B\)</span> when observed from <span class="math notranslate nohighlight">\(A\)</span> is defined as (<a class="reference internal" href="references.html#kane1985" id="id1"><span>[Kane1985]</span></a>, pg.  16):</p>
<div class="math notranslate nohighlight" id="equation-angular-velocity-definition">
<span class="eqno">(54)<a class="headerlink" href="#equation-angular-velocity-definition" title="Link to this equation">¶</a></span>\[{}^A\bar{\omega}^B :=
\left(\frac{{}^A d\hat{b}_y}{dt} \cdot \hat{b}_z\right) \hat{b}_x +
\left(\frac{{}^A d\hat{b}_z}{dt} \cdot \hat{b}_x\right) \hat{b}_y +
\left(\frac{{}^A d\hat{b}_x}{dt} \cdot \hat{b}_y\right) \hat{b}_z
\textrm{.}\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t confuse the left and right superscripts on direction cosine matrices
and angular velocities. <span class="math notranslate nohighlight">\({}^B\mathbf{C}^A\)</span> describes the orientation
of <span class="math notranslate nohighlight">\(B\)</span> rotated with respect to <span class="math notranslate nohighlight">\(A\)</span> and the mapping of vectors in
<span class="math notranslate nohighlight">\(A\)</span> to vectors expressed in <span class="math notranslate nohighlight">\(B\)</span>. Whereas
<span class="math notranslate nohighlight">\({}^A\bar{\omega}^B\)</span> describes the angular velocity of <span class="math notranslate nohighlight">\(B\)</span>
<strong>when observed</strong> from <span class="math notranslate nohighlight">\(A\)</span>.</p>
</div>
<p>If <span class="math notranslate nohighlight">\(B\)</span> is oriented with respect to <span class="math notranslate nohighlight">\(A\)</span> and mutually perpendicular
unit vectors <span class="math notranslate nohighlight">\(\hat{a}_x,\hat{a}_y,\hat{a}_z\)</span> are fixed in <span class="math notranslate nohighlight">\(A\)</span> then
there are these general relationships among the unit vectors of each frame (see
<a class="reference internal" href="orientation.html#direction-cosine-matrices"><span class="std std-ref">Direction Cosine Matrices</span></a>):</p>
<div class="math notranslate nohighlight" id="equation-unit-vector-general-relation">
<span class="eqno">(55)<a class="headerlink" href="#equation-unit-vector-general-relation" title="Link to this equation">¶</a></span>\[\begin{split}\hat{b}_x &amp; = c_{xx} \hat{a}_x + c_{xy} \hat{a}_y + c_{xz} \hat{a}_z \\
\hat{b}_y &amp; = c_{yx} \hat{a}_x + c_{yy} \hat{a}_y + c_{yz} \hat{a}_z \\
\hat{b}_z &amp; = c_{zx} \hat{a}_x + c_{zy} \hat{a}_y + c_{zz} \hat{a}_z\end{split}\]</div>
<p>We can create these equations in SymPy to demonstrate how to work with the
definition of angular velocity. Start by first creating the direction cosine
matrix with time varying elements:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cxx</span><span class="p">,</span> <span class="n">cyy</span><span class="p">,</span> <span class="n">czz</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'c_</span><span class="si">{xx}</span><span class="s1">, c_</span><span class="si">{yy}</span><span class="s1">, c_</span><span class="si">{zz}</span><span class="s1">'</span><span class="p">)</span>
<span class="n">cxy</span><span class="p">,</span> <span class="n">cxz</span><span class="p">,</span> <span class="n">cyx</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'c_</span><span class="si">{xy}</span><span class="s1">, c_</span><span class="si">{xz}</span><span class="s1">, c_</span><span class="si">{yx}</span><span class="s1">'</span><span class="p">)</span>
<span class="n">cyz</span><span class="p">,</span> <span class="n">czx</span><span class="p">,</span> <span class="n">czy</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'c_</span><span class="si">{yz}</span><span class="s1">, c_</span><span class="si">{zx}</span><span class="s1">, c_</span><span class="si">{zy}</span><span class="s1">'</span><span class="p">)</span>

<span class="n">B_C_A</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">cxx</span><span class="p">,</span> <span class="n">cxy</span><span class="p">,</span> <span class="n">cxz</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">cyx</span><span class="p">,</span> <span class="n">cyy</span><span class="p">,</span> <span class="n">cyz</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">czx</span><span class="p">,</span> <span class="n">czy</span><span class="p">,</span> <span class="n">czz</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>and establish the orientation using
<a class="reference external" href="https://docs.sympy.org/latest/modules/physics/vector/api/classes.html#sympy.physics.vector.frame.ReferenceFrame.orient_dcm" title="(in SymPy v1.14.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orient_dcm()</span></code></a>:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Remember this method takes the transpose of the direction cosine matrix.</p>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'B'</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">orient_dcm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B_C_A</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">dcm</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}c_{xx} &amp; c_{xy} &amp; c_{xz}\\c_{yx} &amp; c_{yy} &amp; c_{yz}\\c_{zx} &amp; c_{zy} &amp; c_{zz}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>This now let’s write the <span class="math notranslate nohighlight">\(B\)</span> unit vectors in terms of the <span class="math notranslate nohighlight">\(A\)</span> unit
vectors:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle c_{xx}\hat{a}_x + c_{xy}\hat{a}_y + c_{xz}\hat{a}_z\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle c_{yx}\hat{a}_x + c_{yy}\hat{a}_y + c_{yz}\hat{a}_z\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle c_{zx}\hat{a}_x + c_{zy}\hat{a}_y + c_{zz}\hat{a}_z\]</div>
</div>
</div>
<p>Recalling the definition of angular velocity above, each of the measure numbers
of the angular velocity is calculated by dotting the derivative of a <span class="math notranslate nohighlight">\(B\)</span>
unit vector in <span class="math notranslate nohighlight">\(A\)</span> with a unit vector in <span class="math notranslate nohighlight">\(B\)</span>. <span class="math notranslate nohighlight">\(\frac{{}^A
\hat{b}_y}{dt}\)</span> is for example:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \dot{c}_{yx}\hat{a}_x + \dot{c}_{yy}\hat{a}_y + \dot{c}_{yz}\hat{a}_z\]</div>
</div>
</div>
<p>Each of the measure numbers of <span class="math notranslate nohighlight">\({}^A\bar{\omega}^B\)</span> are then:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mnx</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
<span class="n">mnx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle c_{zx} \dot{c}_{yx} + c_{zy} \dot{c}_{yy} + c_{zz} \dot{c}_{yz}\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mny</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="n">mny</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle c_{xx} \dot{c}_{zx} + c_{xy} \dot{c}_{zy} + c_{xz} \dot{c}_{zz}\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mnz</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<span class="n">mnz</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle c_{yx} \dot{c}_{xx} + c_{yy} \dot{c}_{xy} + c_{yz} \dot{c}_{xz}\]</div>
</div>
</div>
<p>The angular velocity vector for an arbitrary direction cosine matrix is then:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_w_B</span> <span class="o">=</span> <span class="n">mnx</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">mny</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">mnz</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">z</span>
<span class="n">A_w_B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (c_{zx} \dot{c}_{yx} + c_{zy} \dot{c}_{yy} + c_{zz} \dot{c}_{yz})\hat{b}_x + (c_{xx} \dot{c}_{zx} + c_{xy} \dot{c}_{zy} + c_{xz} \dot{c}_{zz})\hat{b}_y + (c_{yx} \dot{c}_{xx} + c_{yy} \dot{c}_{xy} + c_{yz} \dot{c}_{xz})\hat{b}_z\]</div>
</div>
</div>
<p>If you know the direction cosine matrix and the derivative of its entries with
respect to time, the angular velocity can be directly calculated with the above
equation.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>At one instance of time, the direction cosine matrix is:</p>
<div class="math notranslate nohighlight" id="equation-angular-0">
<span class="eqno">(56)<a class="headerlink" href="#equation-angular-0" title="Link to this equation">¶</a></span>\[\begin{split}{}^B\mathbf{C}^A =
\begin{bmatrix}
  \frac{\sqrt{2}}{4} &amp; \frac{\sqrt{2}}{2} &amp; \frac{\sqrt{6}}{4} \\
  -\frac{\sqrt{3}}{2} &amp; 0 &amp; \frac{1}{2} \\
  \frac{\sqrt{2}}{4} &amp; - \frac{\sqrt{2}}{2} &amp; \frac{\sqrt{6}}{4}
\end{bmatrix}\end{split}\]</div>
<p>and the time derivatives of the entries of the direction cosine matrix are:</p>
<div class="math notranslate nohighlight" id="equation-angular-1">
<span class="eqno">(57)<a class="headerlink" href="#equation-angular-1" title="Link to this equation">¶</a></span>\[\begin{split}\frac{d{}^B\mathbf{C}^A}{dt} =
\begin{bmatrix}
  -\frac{\sqrt{6}}{2} - \frac{3 \sqrt{2}}{4} &amp; - \frac{\sqrt{6}}{4} + \frac{3 \sqrt{2}}{2} &amp; - \frac{3 \sqrt{6}}{4} + \sqrt{2}\\
  -1 &amp; - \frac{1}{2} &amp; - \sqrt{3}\\
  - \frac{\sqrt{6}}{2} + \frac{3 \sqrt{2}}{4} &amp; - \frac{\sqrt{6}}{4} + \frac{3 \sqrt{2}}{2} &amp; \frac{3 \sqrt{6}}{4}
\end{bmatrix}\end{split}\]</div>
<p>apply the definition of angular velocity to find <span class="math notranslate nohighlight">\({}^A\bar{\omega}^B\)</span>.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Define the two matrices:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_C_A</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
    <span class="p">[</span> <span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>  <span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>          <span class="mi">0</span><span class="p">,</span>       <span class="n">sm</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span> <span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">B_C_A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\frac{\sqrt{2}}{4} &amp; \frac{\sqrt{2}}{2} &amp; \frac{\sqrt{6}}{4}\\- \frac{\sqrt{3}}{2} &amp; 0 &amp; \frac{1}{2}\\\frac{\sqrt{2}}{4} &amp; - \frac{\sqrt{2}}{2} &amp; \frac{\sqrt{6}}{4}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_C_A_dt</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
    <span class="p">[</span><span class="o">-</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span>
    <span class="p">[</span>                      <span class="o">-</span><span class="mi">1</span><span class="p">,</span>                     <span class="o">-</span><span class="n">sm</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>               <span class="o">-</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span>
    <span class="p">[</span><span class="o">-</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>            <span class="mi">3</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">B_C_A_dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}- \frac{\sqrt{6}}{2} - \frac{3 \sqrt{2}}{4} &amp; - \frac{\sqrt{6}}{4} + \frac{3 \sqrt{2}}{2} &amp; - \frac{3 \sqrt{6}}{4} + \sqrt{2}\\-1 &amp; - \frac{1}{2} &amp; - \sqrt{3}\\- \frac{\sqrt{6}}{2} + \frac{3 \sqrt{2}}{4} &amp; - \frac{\sqrt{6}}{4} + \frac{3 \sqrt{2}}{2} &amp; \frac{3 \sqrt{6}}{4}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Recognizing the pattern in the definition of angular velocity, rows of each
matrix can be matrix multiplied to arrive at the correct measure number:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mnx</span> <span class="o">=</span> <span class="p">(</span><span class="n">B_C_A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span><span class="o">*</span><span class="n">B_C_A_dt</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">mny</span> <span class="o">=</span> <span class="p">(</span><span class="n">B_C_A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">*</span><span class="n">B_C_A_dt</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">mnz</span> <span class="o">=</span> <span class="p">(</span><span class="n">B_C_A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">*</span><span class="n">B_C_A_dt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">A_w_B</span> <span class="o">=</span> <span class="n">mnx</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">mny</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">mnz</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><a class="reference external" href="https://docs.sympy.org/latest/modules/physics/vector/api/classes.html#sympy.physics.vector.vector.Vector.simplify" title="(in SymPy v1.14.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simplify()</span></code></a> applies
<a class="reference external" href="https://docs.sympy.org/latest/modules/simplify/simplify.html#sympy.simplify.simplify.simplify" title="(in SymPy v1.14.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> to each measure number
of a vector:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_w_B</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle -  \frac{3 \sqrt{2}}{4}\hat{b}_x + (3 - \frac{\sqrt{3}}{2})\hat{b}_y + \frac{5 \sqrt{2}}{4}\hat{b}_z\]</div>
</div>
</div>
</div>
</section>
<section id="angular-velocity-of-simple-orientations">
<h2 id="angular-velocity-of-simple-orientations">Angular Velocity of Simple Orientations<a class="headerlink" href="#angular-velocity-of-simple-orientations" title="Link to this heading">¶</a></h2>
<p>For a simple orientation of <span class="math notranslate nohighlight">\(B\)</span> with respect to <span class="math notranslate nohighlight">\(A\)</span> about the
<span class="math notranslate nohighlight">\(z\)</span> axis through <span class="math notranslate nohighlight">\(\theta\)</span> the direction cosine matrix is:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'theta'</span><span class="p">)</span>

<span class="n">B_C_A</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">sm</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">sm</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="o">-</span><span class="n">sm</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">sm</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">B_C_A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\cos{\left(\theta \right)} &amp; \sin{\left(\theta \right)} &amp; 0\\- \sin{\left(\theta \right)} &amp; \cos{\left(\theta \right)} &amp; 0\\0 &amp; 0 &amp; 1\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Applying the definition of angular velocity as before, the angular velocity of
<span class="math notranslate nohighlight">\(B\)</span> in <span class="math notranslate nohighlight">\(A\)</span> is:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'B'</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">orient_dcm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B_C_A</span><span class="p">)</span>

<span class="n">mnx</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
<span class="n">mny</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="n">mnz</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

<span class="n">A_w_B</span> <span class="o">=</span> <span class="n">mnx</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">mny</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">mnz</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">z</span>
<span class="n">A_w_B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (\sin^{2}{\left(\theta \right)} \dot{\theta} + \cos^{2}{\left(\theta \right)} \dot{\theta})\hat{b}_z\]</div>
</div>
</div>
<p>This can be simplified with a trigonometric identity. We can do this with
<a class="reference external" href="https://docs.sympy.org/latest/modules/physics/vector/api/classes.html#sympy.physics.vector.vector.Vector.simplify" title="(in SymPy v1.14.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simplify()</span></code></a> which applies
<code class="docutils literal notranslate"><span class="pre">simplify()</span></code> to each measure number of a vector:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_w_B</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \dot{\theta}\hat{b}_z\]</div>
</div>
</div>
<p>The angular velocity of a simple orientation is simply the time rate of change
of <span class="math notranslate nohighlight">\(\theta\)</span> about <span class="math notranslate nohighlight">\(\hat{b}_z=\hat{a}_z\)</span>, the axis of
the simple orientation. SymPy Mechanics offers the
<a class="reference external" href="https://docs.sympy.org/latest/modules/physics/vector/api/classes.html#sympy.physics.vector.frame.ReferenceFrame.ang_vel_in" title="(in SymPy v1.14.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ang_vel_in()</span></code></a>
method for automatically calculating the angular velocity if a direction cosine
matrix exists between the two reference frames:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'B'</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">orient_axis</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \dot{\theta}\hat{a}_z\]</div>
</div>
</div>
<p>A simple orientation and associated simple angular velocity can be formulated
for any arbitrary orientation axis vector, not just one of the three mutually
perpendicular unit vectors as shown above. There is a simple angular velocity
between two reference frames <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> if there exists a single
unit vector <span class="math notranslate nohighlight">\(\hat{k}\)</span> which is fixed in both <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> for
some finite time. If this is the case, then <span class="math notranslate nohighlight">\({}^A\bar{\omega}^B = \omega
\hat{k}\)</span> where <span class="math notranslate nohighlight">\(\omega\)</span> is the time rate of change of the angle
<span class="math notranslate nohighlight">\(\theta\)</span> between a line fixed in <span class="math notranslate nohighlight">\(A\)</span> and another line fixed in
<span class="math notranslate nohighlight">\(B\)</span> both of which are perpendicular to the orientation axis
<span class="math notranslate nohighlight">\(\hat{k}\)</span>.  We call <span class="math notranslate nohighlight">\(\omega=\dot{\theta}\)</span> the <span class="xref std std-term">angular speed</span>
of <span class="math notranslate nohighlight">\(B\)</span> in <span class="math notranslate nohighlight">\(A\)</span>.
<a class="reference external" href="https://docs.sympy.org/latest/modules/physics/vector/api/classes.html#sympy.physics.vector.frame.ReferenceFrame.orient_axis" title="(in SymPy v1.14.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orient_axis()</span></code></a> can
take any arbitrary vector fixed in <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> to establish the
orientation:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'theta'</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'B'</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">orient_axis</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">A</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{\sqrt{2} \dot{\theta}}{2}\hat{a}_x + \frac{\sqrt{2} \dot{\theta}}{2}\hat{a}_y\]</div>
</div>
</div>
<p>The angular speed is then:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \sqrt{\dot{\theta}^{2}}\]</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This result could more properly be <span class="math notranslate nohighlight">\(|\dot{\theta}|\)</span>. This is an
outstanding issue in SymPy, see <a class="reference external" href="https://github.com/sympy/sympy/issues/23173">https://github.com/sympy/sympy/issues/23173</a>
for more info. This generally will not cause issues, but for certain
equation of motion derivations it could not be ideal, so beware.</p>
</div>
</section>
<section id="body-fixed-orientations">
<h2 id="body-fixed-orientations">Body Fixed Orientations<a class="headerlink" href="#body-fixed-orientations" title="Link to this heading">¶</a></h2>
<p>If you establish a Euler <span class="math notranslate nohighlight">\(z\textrm{-}x\textrm{-}z\)</span> orientation with
angles <span class="math notranslate nohighlight">\(\psi,\theta,\varphi\)</span> respectively, then the angular velocity
vector is:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'psi, theta, varphi'</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'B'</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">orient_body_fixed</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span> <span class="s1">'ZXZ'</span><span class="p">)</span>

<span class="n">mnx</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
<span class="n">mny</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="n">mnz</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

<span class="n">A_w_B</span> <span class="o">=</span> <span class="n">mnx</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">mny</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">mnz</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">z</span>
<span class="n">A_w_B</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \dot{\psi} + \cos{\left(\varphi \right)} \dot{\theta})\hat{b}_x + (\sin{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} - \sin{\left(\varphi \right)} \dot{\theta})\hat{b}_y + (\cos{\left(\theta \right)} \dot{\psi} + \dot{\varphi})\hat{b}_z\]</div>
</div>
</div>
<p>The method
<a class="reference external" href="https://docs.sympy.org/latest/modules/physics/vector/api/classes.html#sympy.physics.vector.frame.ReferenceFrame.ang_vel_in" title="(in SymPy v1.14.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ang_vel_in()</span></code></a> does
this same calculation and gives the same result:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \dot{\psi} + \cos{\left(\varphi \right)} \dot{\theta})\hat{b}_x + (\sin{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} - \sin{\left(\varphi \right)} \dot{\theta})\hat{b}_y + (\cos{\left(\theta \right)} \dot{\psi} + \dot{\varphi})\hat{b}_z\]</div>
</div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Calculate the angular velocity of the T-handle <span class="math notranslate nohighlight">\(T\)</span> with respect to the
space station <span class="math notranslate nohighlight">\(N\)</span> if <span class="math notranslate nohighlight">\(\hat{t}_z\)</span> is parallel to the spin axis,
<span class="math notranslate nohighlight">\(\hat{t}_y\)</span> is parallel with the handle axis, and <span class="math notranslate nohighlight">\(\hat{t}_x\)</span> is
normal to the plane made by the “T” and follows from the right hand rule.
Select Euler angles that avoid <a class="reference external" href="https://en.wikipedia.org/wiki/Gimbal_lock">gimbal lock</a>. <em>Hint: Read “Loss of degree
of freedom with Euler angles” in the gimbal lock article.</em></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'psi, theta, varphi'</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'T'</span><span class="p">)</span>
<span class="n">T</span><span class="o">.</span><span class="n">orient_body_fixed</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span> <span class="s1">'xyz'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>To check whether the <span class="math notranslate nohighlight">\(x\textrm{-}y\textrm{-}z\)</span> body fixed rotation
angles we chose are suitable for the observed moition in the video we first
estimate the likely bounds of motion in terms of multiples of <span class="math notranslate nohighlight">\(\pi/2\)</span>.
For our Euler angles this seems reasonable:</p>
<div class="math notranslate nohighlight" id="equation-angular-2">
<span class="eqno">(58)<a class="headerlink" href="#equation-angular-2" title="Link to this equation">¶</a></span>\[\begin{split}0       \leq \psi    \leq \pi \\
-\pi/2  \leq \theta  \leq \pi/2 \\
-\infty \leq \varphi \leq \infty\end{split}\]</div>
<p>Now we can check the direction cosine matrix at the limits of <span class="math notranslate nohighlight">\(\psi\)</span>
and <span class="math notranslate nohighlight">\(\theta\)</span> to see if they reduce the direction cosine matrix to a
form that indicates gimbal lock.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">dcm</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">xreplace</span><span class="p">({</span><span class="n">psi</span><span class="p">:</span> <span class="mi">0</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\cos{\left(\theta \right)} \cos{\left(\varphi \right)} &amp; \sin{\left(\varphi \right)} &amp; - \sin{\left(\theta \right)} \cos{\left(\varphi \right)}\\- \sin{\left(\varphi \right)} \cos{\left(\theta \right)} &amp; \cos{\left(\varphi \right)} &amp; \sin{\left(\theta \right)} \sin{\left(\varphi \right)}\\\sin{\left(\theta \right)} &amp; 0 &amp; \cos{\left(\theta \right)}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">dcm</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">xreplace</span><span class="p">({</span><span class="n">psi</span><span class="p">:</span> <span class="n">sm</span><span class="o">.</span><span class="n">pi</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\cos{\left(\theta \right)} \cos{\left(\varphi \right)} &amp; - \sin{\left(\varphi \right)} &amp; \sin{\left(\theta \right)} \cos{\left(\varphi \right)}\\- \sin{\left(\varphi \right)} \cos{\left(\theta \right)} &amp; - \cos{\left(\varphi \right)} &amp; - \sin{\left(\theta \right)} \sin{\left(\varphi \right)}\\\sin{\left(\theta \right)} &amp; 0 &amp; - \cos{\left(\theta \right)}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>These first matrices show that we can still orient the handle if
<span class="math notranslate nohighlight">\(\psi\)</span> is at its limits.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">dcm</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">xreplace</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span> <span class="o">-</span><span class="n">sm</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}0 &amp; - \sin{\left(\psi - \varphi \right)} &amp; \cos{\left(\psi - \varphi \right)}\\0 &amp; \cos{\left(\psi - \varphi \right)} &amp; \sin{\left(\psi - \varphi \right)}\\-1 &amp; 0 &amp; 0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">trigsimp</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">dcm</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">xreplace</span><span class="p">({</span><span class="n">theta</span><span class="p">:</span> <span class="n">sm</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}0 &amp; \sin{\left(\psi + \varphi \right)} &amp; - \cos{\left(\psi + \varphi \right)}\\0 &amp; \cos{\left(\psi + \varphi \right)} &amp; \sin{\left(\psi + \varphi \right)}\\1 &amp; 0 &amp; 0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>These second set of matrices show that gimbal lock can occur if
<span class="math notranslate nohighlight">\(\theta\)</span> reaches its limits. But for the observed motion this limit
shouldn’t ever be reached. So we can use this Euler angle set to model the
T-handle for the observed motion without worry of gimbal lock.</p>
</div>
</section>
<section id="time-derivatives-of-vectors">
<h2 id="time-derivatives-of-vectors">Time Derivatives of Vectors<a class="headerlink" href="#time-derivatives-of-vectors" title="Link to this heading">¶</a></h2>
<p>Using the definition of angular velocity one can show (<a class="reference internal" href="references.html#kane1985" id="id3"><span>[Kane1985]</span></a>, pg. 17)
that the time derivative of a unit vector <strong>fixed in</strong> <span class="math notranslate nohighlight">\(B\)</span> is related to
<span class="math notranslate nohighlight">\(B\)</span>’s angular velocity by the following theorem:</p>
<div class="math notranslate nohighlight" id="equation-time-derivative-fixed-unit-vector">
<span class="eqno">(59)<a class="headerlink" href="#equation-time-derivative-fixed-unit-vector" title="Link to this equation">¶</a></span>\[\frac{{}^Ad\hat{b}_x}{dt} = {}^A\bar{\omega}^B \times \hat{b}_x\]</div>
<p>This indicates that the time derivative is always normal to the unit vector
because the magnitude of the unit vector is constant and the derivative scales
with the magnitude of the angular velocity:</p>
<div class="math notranslate nohighlight" id="equation-time-derivative-unit-vector-scalar-mag">
<span class="eqno">(60)<a class="headerlink" href="#equation-time-derivative-unit-vector-scalar-mag" title="Link to this equation">¶</a></span>\[\frac{{}^Ad\hat{b}_x}{dt} = \left| {}^A\bar{\omega}^B \right| \left( {}^A\hat{\omega}^B \times \hat{b}_x \right)\]</div>
<p>Now if vector <span class="math notranslate nohighlight">\(\bar{v} = v\hat{b}_x\)</span> and <span class="math notranslate nohighlight">\(v\)</span> is constant with
respect to time we can infer:</p>
<div class="math notranslate nohighlight" id="equation-time-derivative-fixed-vector">
<span class="eqno">(61)<a class="headerlink" href="#equation-time-derivative-fixed-vector" title="Link to this equation">¶</a></span>\[\frac{{}^A d\bar{v}}{dt} =
v({}^A\bar{\omega}^B \times \hat{b}_x) =
{}^A\bar{\omega}^B \times v\hat{b}_x =
{}^A\bar{\omega}^B \times \bar{v}\]</div>
<p>Eq. <a class="reference internal" href="#equation-time-derivative-fixed-unit-vector">(59)</a> extends to any vector
<strong>fixed in</strong> <span class="math notranslate nohighlight">\(B\)</span> and observed from <span class="math notranslate nohighlight">\(A\)</span>, making the time derivative
equal to the cross product of the angular velocity of <span class="math notranslate nohighlight">\(B\)</span> in <span class="math notranslate nohighlight">\(A\)</span>
with the vector.</p>
<p>Now, if <span class="math notranslate nohighlight">\(\bar{u}\)</span> is a vector that is <strong>not fixed in</strong> <span class="math notranslate nohighlight">\(B\)</span> we
return to the product rule in Section <a class="reference internal" href="differentiation.html#product-rule"><span class="std std-ref">Product Rule</span></a> and first express
<span class="math notranslate nohighlight">\(\bar{u}\)</span> in <span class="math notranslate nohighlight">\(B\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-time-varying-vector">
<span class="eqno">(62)<a class="headerlink" href="#equation-time-varying-vector" title="Link to this equation">¶</a></span>\[\bar{u} = u_1\hat{b}_x + u_2\hat{b}_y + u_3\hat{b}_z\]</div>
<p>Taking the derivative in another reference frame <span class="math notranslate nohighlight">\(A\)</span> by applying the
product rule and applying the above theorems let us arrive at this new theorem:</p>
<div class="math notranslate nohighlight" id="equation-deriv-arb-vector">
<span class="eqno">(63)<a class="headerlink" href="#equation-deriv-arb-vector" title="Link to this equation">¶</a></span>\[\begin{split}\frac{{}^Ad\bar{u}}{dt} &amp;=
\dot{u}_1\hat{b}_x + \dot{u}_2\hat{b}_y + \dot{u}_3\hat{b}_z +
u_1\frac{{}^Ad\hat{b}_x}{dt} + u_2\frac{{}^Ad\hat{b}_y}{dt} + u_3\frac{{}^Ad\hat{b}_z}{dt} \\
\frac{{}^Ad\bar{u}}{dt} &amp;=
\frac{{}^Bd\bar{u}}{dt} +
u_1{}^A\bar{\omega}^B\times\hat{b}_x + u_2{}^A\bar{\omega}^B\times\hat{b}_y + u_3{}^A\bar{\omega}^B\times\hat{b}_z \\
\frac{{}^Ad\bar{u}}{dt} &amp;=
\frac{{}^Bd\bar{u}}{dt} +
{}^A\bar{\omega}^B\times\bar{u}\end{split}\]</div>
<p>Eq. <a class="reference internal" href="#equation-deriv-arb-vector">(63)</a> is a powerful equation because it lets us
differentiate any vector if we know how it changes in a rotating reference
frame relative to the reference frame we are observing the change from.</p>
<p>We can show that Eq. <a class="reference internal" href="#equation-deriv-arb-vector">(63)</a> holds with an example.
Take a <span class="math notranslate nohighlight">\(z\textrm{-}x\)</span> orientation and an arbitrary vector that is not
fixed in <span class="math notranslate nohighlight">\(B\)</span>:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'B'</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">orient_body_fixed</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">'ZXZ'</span><span class="p">)</span>

<span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">,</span> <span class="n">u3</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'u1, u2, u3'</span><span class="p">)</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">u1</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">u2</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">u3</span><span class="o">*</span><span class="n">B</span><span class="o">.</span><span class="n">z</span>
<span class="n">u</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle u_{1}\hat{b}_x + u_{2}\hat{b}_y + u_{3}\hat{b}_z\]</div>
</div>
</div>
<p>As we learned in the last chapter we can express the vector in <span class="math notranslate nohighlight">\(A\)</span> and
then take the time derivative of the measure numbers to arrive at
<span class="math notranslate nohighlight">\(\frac{{}^Ad\bar{u}}{dt}\)</span>:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (u_{1} \cos{\left(\psi \right)} - u_{2} \sin{\left(\psi \right)} \cos{\left(\theta \right)} + u_{3} \sin{\left(\psi \right)} \sin{\left(\theta \right)})\hat{a}_x + (u_{1} \sin{\left(\psi \right)} + u_{2} \cos{\left(\psi \right)} \cos{\left(\theta \right)} - u_{3} \sin{\left(\theta \right)} \cos{\left(\psi \right)})\hat{a}_y + (u_{2} \sin{\left(\theta \right)} + u_{3} \cos{\left(\theta \right)})\hat{a}_z\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (- u_{1} \sin{\left(\psi \right)} \dot{\psi} + u_{2} \sin{\left(\psi \right)} \sin{\left(\theta \right)} \dot{\theta} - u_{2} \cos{\left(\psi \right)} \cos{\left(\theta \right)} \dot{\psi} + u_{3} \sin{\left(\psi \right)} \cos{\left(\theta \right)} \dot{\theta} + u_{3} \sin{\left(\theta \right)} \cos{\left(\psi \right)} \dot{\psi} + \sin{\left(\psi \right)} \sin{\left(\theta \right)} \dot{u}_{3} - \sin{\left(\psi \right)} \cos{\left(\theta \right)} \dot{u}_{2} + \cos{\left(\psi \right)} \dot{u}_{1})\hat{a}_x + (u_{1} \cos{\left(\psi \right)} \dot{\psi} - u_{2} \sin{\left(\psi \right)} \cos{\left(\theta \right)} \dot{\psi} - u_{2} \sin{\left(\theta \right)} \cos{\left(\psi \right)} \dot{\theta} + u_{3} \sin{\left(\psi \right)} \sin{\left(\theta \right)} \dot{\psi} - u_{3} \cos{\left(\psi \right)} \cos{\left(\theta \right)} \dot{\theta} + \sin{\left(\psi \right)} \dot{u}_{1} - \sin{\left(\theta \right)} \cos{\left(\psi \right)} \dot{u}_{3} + \cos{\left(\psi \right)} \cos{\left(\theta \right)} \dot{u}_{2})\hat{a}_y + (u_{2} \cos{\left(\theta \right)} \dot{\theta} - u_{3} \sin{\left(\theta \right)} \dot{\theta} + \sin{\left(\theta \right)} \dot{u}_{2} + \cos{\left(\theta \right)} \dot{u}_{3})\hat{a}_z\]</div>
</div>
</div>
<p>But applying the theorem above we can find the derivative with a cross product.
The nice aspect of this formulation is there is no need to express the vector
in <span class="math notranslate nohighlight">\(A\)</span>. First <span class="math notranslate nohighlight">\(\frac{{}^Bd\bar{u}}{dt}\)</span>:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \dot{u}_{1}\hat{b}_x + \dot{u}_{2}\hat{b}_y + \dot{u}_{3}\hat{b}_z\]</div>
</div>
</div>
<p>and then <span class="math notranslate nohighlight">\({}^A\bar{\omega}^B\)</span>:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_w_B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">A_w_B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \dot{\theta}\hat{b}_x + \sin{\left(\theta \right)} \dot{\psi}\hat{b}_y + \cos{\left(\theta \right)} \dot{\psi}\hat{b}_z\]</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\frac{{}^Ad\bar{u}}{dt}\)</span> is then:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="n">me</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">A_w_B</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (- u_{2} \cos{\left(\theta \right)} \dot{\psi} + u_{3} \sin{\left(\theta \right)} \dot{\psi} + \dot{u}_{1})\hat{b}_x + (u_{1} \cos{\left(\theta \right)} \dot{\psi} - u_{3} \dot{\theta} + \dot{u}_{2})\hat{b}_y + (- u_{1} \sin{\left(\theta \right)} \dot{\psi} + u_{2} \dot{\theta} + \dot{u}_{3})\hat{b}_z\]</div>
</div>
</div>
<p>which is a relatively simple form of the derivative when expressed in the
rotating reference frame.</p>
<p>We can show that the first result is equivalent by expressing in <span class="math notranslate nohighlight">\(B\)</span> and
simplifying:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (- u_{2} \cos{\left(\theta \right)} \dot{\psi} + u_{3} \sin{\left(\theta \right)} \dot{\psi} + \dot{u}_{1})\hat{b}_x + (u_{1} \cos{\left(\theta \right)} \dot{\psi} - u_{3} \dot{\theta} + \dot{u}_{2})\hat{b}_y + (- u_{1} \sin{\left(\theta \right)} \dot{\psi} + u_{2} \dot{\theta} + \dot{u}_{3})\hat{b}_z\]</div>
</div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Show that <code class="docutils literal notranslate"><span class="pre">.dt()</span></code> uses the theorem Eq. <a class="reference internal" href="#equation-deriv-arb-vector">(63)</a>
internally.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (- u_{2} \cos{\left(\theta \right)} \dot{\psi} + u_{3} \sin{\left(\theta \right)} \dot{\psi} + \dot{u}_{1})\hat{b}_x + (u_{1} \cos{\left(\theta \right)} \dot{\psi} - u_{3} \dot{\theta} + \dot{u}_{2})\hat{b}_y + (- u_{1} \sin{\left(\theta \right)} \dot{\psi} + u_{2} \dot{\theta} + \dot{u}_{3})\hat{b}_z\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="n">me</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">A_w_B</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (- u_{2} \cos{\left(\theta \right)} \dot{\psi} + u_{3} \sin{\left(\theta \right)} \dot{\psi} + \dot{u}_{1})\hat{b}_x + (u_{1} \cos{\left(\theta \right)} \dot{\psi} - u_{3} \dot{\theta} + \dot{u}_{2})\hat{b}_y + (- u_{1} \sin{\left(\theta \right)} \dot{\psi} + u_{2} \dot{\theta} + \dot{u}_{3})\hat{b}_z\]</div>
</div>
</div>
</div>
</section>
<section id="addition-of-angular-velocity">
<h2 id="addition-of-angular-velocity">Addition of Angular Velocity<a class="headerlink" href="#addition-of-angular-velocity" title="Link to this heading">¶</a></h2>
<p>Similar to the relationship in direction cosine matrices of successive
orientations (Sec. <a class="reference internal" href="orientation.html#successive-orientations"><span class="std std-ref">Successive Orientations</span></a>), there is a relationship
among the angular velocities of successively oriented reference frames
(<a class="reference internal" href="references.html#kane1985" id="id4"><span>[Kane1985]</span></a>, pg. 24) but it relies on the addition of vectors instead of
multiplication of matrices. The theorem is:</p>
<div class="math notranslate nohighlight" id="equation-addition-angular-velocity">
<span class="eqno">(64)<a class="headerlink" href="#equation-addition-angular-velocity" title="Link to this equation">¶</a></span>\[{}^A\bar{\omega}^Z =
{}^A\bar{\omega}^B +
{}^B\bar{\omega}^C +
\ldots +
{}^Y\bar{\omega}^Z\]</div>
<p>We can demonstrate this by creating three simple orientations for a Euler
<span class="math notranslate nohighlight">\(y\textrm{-}x\textrm{-}y\)</span> orientation:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'psi, theta, varphi'</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'B'</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'C'</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'D'</span><span class="p">)</span>

<span class="n">B</span><span class="o">.</span><span class="n">orient_axis</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<span class="n">C</span><span class="o">.</span><span class="n">orient_axis</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">orient_axis</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>The simple angular velocity of each successive orientation is shown:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_w_B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">A_w_B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \dot{\psi}\hat{a}_y\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_w_C</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="n">B_w_C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \dot{\theta}\hat{b}_x\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C_w_D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="n">C_w_D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \dot{\varphi}\hat{c}_y\]</div>
</div>
</div>
<p>Summing the successive angular velocities gives the compact result:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_w_D</span> <span class="o">=</span> <span class="n">A_w_B</span> <span class="o">+</span> <span class="n">B_w_C</span> <span class="o">+</span> <span class="n">C_w_D</span>
<span class="n">A_w_D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \dot{\psi}\hat{a}_y + \dot{\theta}\hat{b}_x + \dot{\varphi}\hat{c}_y\]</div>
</div>
</div>
<p>Similarly, we can skip the auxiliary frames and form the relationship between
<span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(D\)</span> directly and calculate <span class="math notranslate nohighlight">\({}^A\bar{\omega}^D\)</span>:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A2</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">D2</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'D'</span><span class="p">)</span>
<span class="n">D2</span><span class="o">.</span><span class="n">orient_body_fixed</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span> <span class="s1">'YXY'</span><span class="p">)</span>
<span class="n">D2</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \dot{\psi} + \cos{\left(\varphi \right)} \dot{\theta})\hat{d}_x + (\cos{\left(\theta \right)} \dot{\psi} + \dot{\varphi})\hat{d}_y + (- \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} + \sin{\left(\varphi \right)} \dot{\theta})\hat{d}_z\]</div>
</div>
</div>
<p>If we express our prior result in <span class="math notranslate nohighlight">\(D\)</span> we see the results are the same:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_w_D</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \dot{\psi} + \cos{\left(\varphi \right)} \dot{\theta})\hat{d}_x + (\cos{\left(\theta \right)} \dot{\psi} + \dot{\varphi})\hat{d}_y + (- \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} + \sin{\left(\varphi \right)} \dot{\theta})\hat{d}_z\]</div>
</div>
</div>
</section>
<section id="angular-acceleration">
<h2 id="angular-acceleration">Angular Acceleration<a class="headerlink" href="#angular-acceleration" title="Link to this heading">¶</a></h2>
<p>The angular acceleration of <span class="math notranslate nohighlight">\(B\)</span> when observed from <span class="math notranslate nohighlight">\(A\)</span> is defined
as:</p>
<div class="math notranslate nohighlight" id="equation-angular-acceleration-definition">
<span class="eqno">(65)<a class="headerlink" href="#equation-angular-acceleration-definition" title="Link to this equation">¶</a></span>\[{}^A\bar{\alpha}^B := \frac{{}^Ad}{dt} {}^A\bar{\omega}^B\]</div>
<p><span class="math notranslate nohighlight">\({}^A\bar{\omega}^B\)</span> is simply a vector so we can time differentiate it
with respect to frame <span class="math notranslate nohighlight">\(A\)</span>. Using Eq. <a class="reference internal" href="#equation-deriv-arb-vector">(63)</a> we
can write:</p>
<div class="math notranslate nohighlight" id="equation-angular-acceleration-cross">
<span class="eqno">(66)<a class="headerlink" href="#equation-angular-acceleration-cross" title="Link to this equation">¶</a></span>\[\begin{split}\frac{{}^Ad}{dt} {}^A\bar{\omega}^B &amp; =
\frac{{}^Bd}{dt} {}^A\bar{\omega}^B + {}^A\bar{\omega}^B \times {}^A\bar{\omega}^B \\\end{split}\]</div>
<p>and since <span class="math notranslate nohighlight">\({}^A\bar{\omega}^B \times {}^A\bar{\omega}^B=0\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-ang-acc-frame">
<span class="eqno">(67)<a class="headerlink" href="#equation-ang-acc-frame" title="Link to this equation">¶</a></span>\[\frac{{}^Ad}{dt} {}^A\bar{\omega}^B = \frac{{}^Bd}{dt} {}^A\bar{\omega}^B\]</div>
<p>which is rather convenient.</p>
<p>With SymPy Mechanics <span class="math notranslate nohighlight">\({}^A\bar{\alpha}^B\)</span> is found automatically with
<a class="reference external" href="https://docs.sympy.org/latest/modules/physics/vector/api/classes.html#sympy.physics.vector.frame.ReferenceFrame.ang_acc_in" title="(in SymPy v1.14.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ang_acc_in()</span></code></a> if
the orientations are established. For a simple orientation:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'theta'</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'B'</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">orient_axis</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
<span class="n">B</span><span class="o">.</span><span class="n">ang_acc_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \ddot{\theta}\hat{a}_z\]</div>
</div>
</div>
<p>Similarly we can calculate the derivative manually:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \ddot{\theta}\hat{a}_z\]</div>
</div>
</div>
<p>and see that that Eq. <a class="reference internal" href="#equation-ang-acc-frame">(67)</a> holds:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \ddot{\theta}\hat{a}_z\]</div>
</div>
</div>
<p>For a body fixed orientation we get:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'psi, theta, varphi'</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'D'</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">orient_body_fixed</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span> <span class="s1">'YXY'</span><span class="p">)</span>

<span class="n">D</span><span class="o">.</span><span class="n">ang_acc_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \ddot{\psi} + \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} \dot{\varphi} + \sin{\left(\varphi \right)} \cos{\left(\theta \right)} \dot{\psi} \dot{\theta} - \sin{\left(\varphi \right)} \dot{\theta} \dot{\varphi} + \cos{\left(\varphi \right)} \ddot{\theta})\hat{d}_x + (- \sin{\left(\theta \right)} \dot{\psi} \dot{\theta} + \cos{\left(\theta \right)} \ddot{\psi} + \ddot{\varphi})\hat{d}_y + (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \dot{\psi} \dot{\varphi} - \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \ddot{\psi} + \sin{\left(\varphi \right)} \ddot{\theta} - \cos{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} \dot{\theta} + \cos{\left(\varphi \right)} \dot{\theta} \dot{\varphi})\hat{d}_z\]</div>
</div>
</div>
<p>and with manual derivatives of the measure numbers:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \ddot{\psi} + \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} \dot{\varphi} + \sin{\left(\varphi \right)} \cos{\left(\theta \right)} \dot{\psi} \dot{\theta} - \sin{\left(\varphi \right)} \dot{\theta} \dot{\varphi} + \cos{\left(\varphi \right)} \ddot{\theta})\hat{d}_x + (- \sin{\left(\theta \right)} \dot{\psi} \dot{\theta} + \cos{\left(\theta \right)} \ddot{\psi} + \ddot{\varphi})\hat{d}_y + (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \dot{\psi} \dot{\varphi} - \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \ddot{\psi} + \sin{\left(\varphi \right)} \ddot{\theta} - \cos{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} \dot{\theta} + \cos{\left(\varphi \right)} \dot{\theta} \dot{\varphi})\hat{d}_z\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \ddot{\psi} + \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} \dot{\varphi} + \sin{\left(\varphi \right)} \cos{\left(\theta \right)} \dot{\psi} \dot{\theta} - \sin{\left(\varphi \right)} \dot{\theta} \dot{\varphi} + \cos{\left(\varphi \right)} \ddot{\theta})\hat{d}_x + (- \sin{\left(\theta \right)} \dot{\psi} \dot{\theta} + \cos{\left(\theta \right)} \ddot{\psi} + \ddot{\varphi})\hat{d}_y + (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \dot{\psi} \dot{\varphi} - \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \ddot{\psi} + \sin{\left(\varphi \right)} \ddot{\theta} - \cos{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} \dot{\theta} + \cos{\left(\varphi \right)} \dot{\theta} \dot{\varphi})\hat{d}_z\]</div>
</div>
</div>
<p>Note the equivalence regardless of the frame the change in velocity is observed
from.</p>
</section>
<section id="addition-of-angular-acceleration">
<h2 id="addition-of-angular-acceleration">Addition of Angular Acceleration<a class="headerlink" href="#addition-of-angular-acceleration" title="Link to this heading">¶</a></h2>
<p>The calculation of angular acceleration is relatively simple due to the
equivalence when observed from different reference frames, but the addition of
angular velocities explained in Sec. <a class="reference internal" href="#addition-of-angular-velocity"><span class="std std-ref">Addition of Angular Velocity</span></a> does
not extend to angular accelerations. Adding successive angular accelerations
does not result in a valid total angular acceleration.</p>
<div class="math notranslate nohighlight" id="equation-addition-angular-acceleration">
<span class="eqno">(68)<a class="headerlink" href="#equation-addition-angular-acceleration" title="Link to this equation">¶</a></span>\[{}^A\bar{\alpha}^Z \neq
{}^A\bar{\alpha}^B +
{}^B\bar{\alpha}^C +
\ldots +
{}^Y\bar{\alpha}^Z\]</div>
<p>We can show by example that an equality in Eq.
<a class="reference internal" href="#equation-addition-angular-acceleration">(68)</a> will  not hold. Coming back to the
successive orientations that form a <span class="math notranslate nohighlight">\(y\textrm{-}x\textrm{-}y\)</span> Euler
rotation, we can test the relationship.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">'psi, theta, varphi'</span><span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'B'</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'C'</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">'D'</span><span class="p">)</span>

<span class="n">B</span><span class="o">.</span><span class="n">orient_axis</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<span class="n">C</span><span class="o">.</span><span class="n">orient_axis</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">orient_axis</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>The simple angular acceleration of each successive orientation is shown:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_alp_B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">ang_acc_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">A_alp_B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \ddot{\psi}\hat{a}_y\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_alp_C</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ang_acc_in</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="n">B_alp_C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \ddot{\theta}\hat{b}_x\]</div>
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C_alp_D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">ang_acc_in</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="n">C_alp_D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \ddot{\varphi}\hat{c}_y\]</div>
</div>
</div>
<p>Summing the successive angular accelerations and expressing the resulting
vector in the body fixed reference frame <span class="math notranslate nohighlight">\(D\)</span> gives this result:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_alp_D</span> <span class="o">=</span> <span class="n">A_alp_B</span> <span class="o">+</span> <span class="n">B_alp_C</span> <span class="o">+</span> <span class="n">C_alp_D</span>
<span class="n">A_alp_D</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \ddot{\psi} + \cos{\left(\varphi \right)} \ddot{\theta})\hat{d}_x + (\cos{\left(\theta \right)} \ddot{\psi} + \ddot{\varphi})\hat{d}_y + (- \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \ddot{\psi} + \sin{\left(\varphi \right)} \ddot{\theta})\hat{d}_z\]</div>
</div>
</div>
<p>which is not equal to the correct, more complex, result:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">ang_vel_in</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">express</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \ddot{\psi} + \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} \dot{\varphi} + \sin{\left(\varphi \right)} \cos{\left(\theta \right)} \dot{\psi} \dot{\theta} - \sin{\left(\varphi \right)} \dot{\theta} \dot{\varphi} + \cos{\left(\varphi \right)} \ddot{\theta})\hat{d}_x + (- \sin{\left(\theta \right)} \dot{\psi} \dot{\theta} + \cos{\left(\theta \right)} \ddot{\psi} + \ddot{\varphi})\hat{d}_y + (\sin{\left(\theta \right)} \sin{\left(\varphi \right)} \dot{\psi} \dot{\varphi} - \sin{\left(\theta \right)} \cos{\left(\varphi \right)} \ddot{\psi} + \sin{\left(\varphi \right)} \ddot{\theta} - \cos{\left(\theta \right)} \cos{\left(\varphi \right)} \dot{\psi} \dot{\theta} + \cos{\left(\varphi \right)} \dot{\theta} \dot{\varphi})\hat{d}_z\]</div>
</div>
</div>
<p>Angular accelerations derived from successive orientations require an explicit
differentiation of the associated angular velocity vector. There unfortunately
is no theorem that simplifies this calculation as we see with orientation and
angular velocity.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="differentiation.html" title="Vector Differentiation"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Vector Differentiation </span>
              </div>
            </a>
          
          
            <a href="translational.html" title="Translational Kinematics"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Translational Kinematics </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2022-2026, Jason K. Moore.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>